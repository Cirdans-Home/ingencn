
<!DOCTYPE html>

<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Laboratorio 3 : L’Aritmetica di Precisione Finita &#8212; Calcolo Numerico - Esercitazioni di Laboratorio</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Indice" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Laboratorio 4 : Il Metodo di Bisezione" href="laboratorio4.html" />
    <link rel="prev" title="Laboratorio 2 : Introduzione a MATLAB - II" href="laboratorio2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="it">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Calcolo Numerico - Esercitazioni di Laboratorio</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Calcolo Numerico - Esercitazioni di Laboratorio
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio1.html">
   Laboratorio 1 : Introduzione a MATLAB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio2.html">
   Laboratorio 2 : Introduzione a MATLAB - II
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Laboratorio 3 : L’Aritmetica di Precisione Finita
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio4.html">
   Laboratorio 4 : Il Metodo di Bisezione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio5.html">
   Laboratorio 5 : Il Metodo di Newton
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio6.html">
   Laboratorio 6 : Soluzione dei Sistemi Lineari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio7.html">
   Laboratorio 7 : L’Eliminazione di Gauss il Metodo LU
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio8.html">
   Laboratorio 8 : Metodi Stazionari per Sistemi Lineari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio9.html">
   Laboratorio 9 : Metodi di Interpolazione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio10.html">
   Laboratorio 10 : Il Problema Lineare dei Minimi Quadrati
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio11.html">
   Laboratorio 11 : Metodi di Quadratura
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio12.html">
   Laboratorio 12 : Metodi per la Soluzione di ODE
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Cirdans-Home/ingencn"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Cirdans-Home/ingencn/issues/new?title=Issue%20on%20page%20%2Flaboratorio3.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/laboratorio3.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rappresentazione-dei-numeri-di-macchina">
   Rappresentazione dei numeri di macchina
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#associativita-delle-operazioni">
   Associatività delle operazioni
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#errori-di-cancellazione-roundoff">
   Errori di cancellazione/roundoff
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#precisione-mista">
   Precisione mista
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bibliografia">
   Bibliografia
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Laboratorio 3 : L’Aritmetica di Precisione Finita</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rappresentazione-dei-numeri-di-macchina">
   Rappresentazione dei numeri di macchina
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#associativita-delle-operazioni">
   Associatività delle operazioni
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#errori-di-cancellazione-roundoff">
   Errori di cancellazione/roundoff
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#precisione-mista">
   Precisione mista
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bibliografia">
   Bibliografia
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="laboratorio-3-l-aritmetica-di-precisione-finita">
<h1>Laboratorio 3 : L’Aritmetica di Precisione Finita<a class="headerlink" href="#laboratorio-3-l-aritmetica-di-precisione-finita" title="Link a questa intestazione">#</a></h1>
<p>Ricordiamo che l’artimetica <strong>floating point</strong> (floating-point arithmetic) è
l’artimetica che fornisce una rappresentazione approssimata dei numeri reali
per supportare un compromesso tra l’intervallo dei numeri rappresentati e la
precisione ottenibile nei calcoli. Per questo motivo, il calcolo in virgola
mobile viene spesso utilizzato in sistemi in cui si deve coniugare la
rappresentazione di numeri in un ampio range richiedendo tuttavia tempi di
elaborazione rapidi.</p>
<p>Un numero in virgola mobile è rappresentato approssimativamente da un numero
fisso di cifre significative (il significando) e scalato usando un esponente
in una qualche base fissata. Tale base è normalmente due, dieci o sedici.
Un numero che può essere rappresentato esattamente è della forma seguente:</p>
<div class="math notranslate nohighlight" id="equation-eq-numeromacchina">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-numeromacchina" title="Permalink a questa equazione">#</a></span>\[ \text{significando} \times \text{base}^{\text{esponente}}.\]</div>
<p>Di tutte le possibili costruzioni di questo tipo, noi adoperiamo quella
codificata nello standard IEEE-754 <span id="id1">[<a class="reference internal" href="#id8" title="IEEE-754. IEEE 754-2019, Standard for Floating-Point Arithmetic. IEEE, New York, NY, USA, June 2019. ISBN 1-5044-5925-3 (print), 1-5044-5924-5 (e-PDF). URL: https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8766229, doi:https://doi.org/10.1109/IEEESTD.2019.876622.">IEEE75419</a>]</span>, in cui
(la maggior parte dei) i numeri <em>floating point</em> sono
normalizzati, cioè possono essere espressi come</p>
<div class="math notranslate nohighlight" id="equation-rappresentazione">
<span class="eqno">(2)<a class="headerlink" href="#equation-rappresentazione" title="Permalink a questa equazione">#</a></span>\[x = \pm (1+f) 2^e, \qquad 0 \leq f &lt; 1, \qquad -1022 \leq e \leq 1023,\]</div>
<p>dove <span class="math notranslate nohighlight">\(f\)</span> è detta la <strong>mantissa</strong>, e deve essere rappresentabile con al più 52 bits,
cioè <span class="math notranslate nohighlight">\(2^{52}f\)</span> è un intero nell’intervallo <span class="math notranslate nohighlight">\(0 \leq 2^{52} f &lt; 2^{53}\)</span>, abbiamo
fissato la base a <span class="math notranslate nohighlight">\(2\)</span> e chiamato l’esponente <span class="math notranslate nohighlight">\(e\)</span>.</p>
<p>Il testo di riferimento per questi argomenti è <span id="id2">[<a class="reference internal" href="#id5" title="Nicholas J. Higham. Accuracy and stability of numerical algorithms. Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA, second edition, 2002. ISBN 0-89871-521-0. URL: https://doi.org/10.1137/1.9780898718027, doi:10.1137/1.9780898718027.">Hig02</a>]</span>.</p>
<p>MATLAB implementa diversi formati di numeri <em>floating point</em> e <em>interi</em>; si
veda la <a class="reference internal" href="#classiintere"><span class="std std-numref">Tabella 8</span></a> per i diversi tipi di interi disponibili e le
relative funzioni di conversione. In generale assumeremo di star lavorando con
l’aritmetica in precisione doppia (<code class="docutils literal notranslate"><span class="pre">double</span></code>): cioè di usare una <strong>rappresentazione
con 64 bits</strong>. Specificamente, il bit 63 assume valore <span class="math notranslate nohighlight">\(0\)</span> o <span class="math notranslate nohighlight">\(1\)</span> per indicare
il segno (<span class="math notranslate nohighlight">\(0\)</span> se positivo, <span class="math notranslate nohighlight">\(1\)</span> se negativo). I bits da 62 a 52 contengono
l’esponente <span class="math notranslate nohighlight">\(e\)</span>, mentre i bits da 51 a 0 contengo la mantissa <span class="math notranslate nohighlight">\(f\)</span> come illustrato
in <a class="reference internal" href="#equation-rappresentazione">(2)</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Avvertimento</p>
<p>In alcuni casi MATLAB deciderà autonomamente se la variabile che stiamo usando
è un <em>intero</em> e applicherà in tal caso l’aritmetica relativa. Alcune funzioni
utili a verificare che tipo di aritmetica stiamo usando sono le funzioni
<code class="docutils literal notranslate"><span class="pre">isfloat</span></code> e <code class="docutils literal notranslate"><span class="pre">isinteger</span></code> che restituiscono <strong>vero</strong> (<span class="math notranslate nohighlight">\(1\)</span>) se l’argomento è
rispettivamente un <em>floating point</em> (<code class="docutils literal notranslate"><span class="pre">single</span></code> o <code class="docutils literal notranslate"><span class="pre">double</span></code>), oppure una delle
tipologie di intero, <strong>falso</strong> (<span class="math notranslate nohighlight">\(0\)</span>) altrimenti.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title">Classi Numeriche</p>
<table class="table" id="classiintere">
<caption><span class="caption-number">Tabella 8 </span><span class="caption-text">Classi di numeri interi</span><a class="headerlink" href="#classiintere" title="Link a questa tabella">#</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Classe</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Conversione</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Signed 8-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(-2^7\)</span> a <span class="math notranslate nohighlight">\(2^7-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int8</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Signed 16-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(-2^{15}\)</span> a <span class="math notranslate nohighlight">\(2^{15}-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int16</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Signed 32-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(-2^{31}\)</span> a <span class="math notranslate nohighlight">\(2^{31}-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int32</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Signed 64-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(-2^{63}\)</span> a <span class="math notranslate nohighlight">\(2^{63}-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int64</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Unsigned 8-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span> a <span class="math notranslate nohighlight">\(2^{8}-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uint8</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Unsigned 16-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span> a <span class="math notranslate nohighlight">\(2^{16}-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uint16</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Unsigned 32-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span> a <span class="math notranslate nohighlight">\(2^{32}-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uint32</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Unsigned 64-bit integer</p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span> a <span class="math notranslate nohighlight">\(2^{64}-1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uint64</span></code></p></td>
</tr>
</tbody>
</table>
</aside>
<section id="rappresentazione-dei-numeri-di-macchina">
<h2>Rappresentazione dei numeri di macchina<a class="headerlink" href="#rappresentazione-dei-numeri-di-macchina" title="Link a questa intestazione">#</a></h2>
<p>In generale non tutti i numeri potranno essere espressi nella forma <a class="reference internal" href="#equation-eq-numeromacchina">(1)</a>,
possiamo scegliere ad esempio il numero <span class="math notranslate nohighlight">\(4/3\)</span> che non può essere scritto esattamente nella
forma <span class="math notranslate nohighlight">\(s \times 2^k\)</span>. Se proviamo ad eseguire l’operazione</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>da cui ci aspetteremo di ottenere uno <span class="math notranslate nohighlight">\(0\)</span>, otteniamo invece</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span>
   <span class="mf">2.2204e-16</span>
</pre></div>
</div>
<p>che è un errore della grandezza della <em>precisione di macchina</em> per l’aritmetica
in virgola mobile adoperata da MATLAB.</p>
<p>In maniera analoga, possiamo considerare un altro numero che non è esattamente
rappresentato in macchina <span class="math notranslate nohighlight">\(0.1\)</span>. Se lo sommiamo <span class="math notranslate nohighlight">\(10\)</span> volte in aritmetica esatta
ci aspettiamo di ottenere <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="w"></span>
<span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<p>Tuttavia se proviamo a fare la verifica leggiamo</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">  </span><span class="nb">logical</span><span class="w"></span>

<span class="w">   </span><span class="mi">0</span><span class="w"></span>
</pre></div>
</div>
<p>Ed infatti,</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">   </span><span class="mf">1.1102e-16</span><span class="w"></span>
</pre></div>
</div>
<p>che è di nuovo dell’ordine della precisione di macchina.</p>
<div class="admonition tip">
<p class="admonition-title">Suggerimento</p>
<p>Quando impostiamo dei confronti di «uguaglianza» tra numeri <em>floating point</em> la
procedura corretta è sempre quella di controllare la differenza in valore
assoluto tra il valore calcolato ed il risultato aspettato in termine della
precisione di macchina in uso:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nb">eps</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w"> </span><span class="nb">logical</span><span class="w"></span>

<span class="w">  </span><span class="mi">1</span><span class="w"></span>
</pre></div>
</div>
<p>che ci restituisce il valore aspettato, dove <code class="docutils literal notranslate"><span class="pre">eps</span></code> è spesso chiamato <em>floating-point
zero</em>.</p>
</div>
<p>All’altro estremo del range dinamico dei numeri rappresentati osserviamo anche
il problema del «diradarsi» dei numeri di macchina, infatti sfruttando la
definizione di numero normalizzato osserviamo facilmente che:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">2</span>^<span class="mi">53</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span>^<span class="mi">53</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">     </span><span class="mi">0</span><span class="w"></span>
</pre></div>
</div>
<p>Possiamo farci dire da MATLAB quali sono il più piccolo ed il più grande numero
reale rappresentato richiamando le variabili <code class="docutils literal notranslate"><span class="pre">realmin</span></code> e <code class="docutils literal notranslate"><span class="pre">realmax</span></code>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nb">realmin</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">  </span><span class="mf">2.2251e-308</span><span class="w"></span>

<span class="o">&gt;&gt;</span><span class="w"> </span><span class="nb">realmax</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">  </span><span class="mf">1.7977e+308</span><span class="w"></span>
</pre></div>
</div>
<p>Qualunque operazione generi un numero maggiore di <code class="docutils literal notranslate"><span class="pre">realmax</span></code> provocherà un errore
di <strong>overflow</strong>, qualunque operazione generi un numero minore di <code class="docutils literal notranslate"><span class="pre">realmin</span></code> genererà
un errore di <strong>underflow</strong>. In MATLAB questo è rappresento dai valori <code class="docutils literal notranslate"><span class="pre">+Inf</span></code> e <code class="docutils literal notranslate"><span class="pre">-Inf</span></code>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">realmax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">.0001e+308</span><span class="w"></span>
<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">   </span><span class="nb">Inf</span><span class="w"></span>

<span class="o">-</span><span class="nb">realmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">.0001e+308</span><span class="w"></span>
<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span><span class="nb">Inf</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Avvertimento</p>
<p>Alcune macchine permettono il trattamento di alcuni casi eccezionali di numeri
<em>floating point</em>, cioè l’esistenza di numeri <em>denormalizzati</em> (o <em>subnormali</em>).
Questi si trovano nell’intevallo [<code class="docutils literal notranslate"><span class="pre">eps*realmin</span></code>,<code class="docutils literal notranslate"><span class="pre">realmin</span></code>].</p>
</div>
<p>L’ultimo caso che vogliamo discutere riguarda l’uso delle funzioni trigonometriche.
Dalla goniometria di base sappiamo che <span class="math notranslate nohighlight">\(\sin(k \pi) = 0\)</span> per ogni <span class="math notranslate nohighlight">\(k\)</span> dispari.
Tuttavia è immediato osservare che</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="nb">pi</span><span class="p">)</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">     </span><span class="mf">3.673940397442059e-16</span><span class="w"></span>
</pre></div>
</div>
<p>Poiché di <span class="math notranslate nohighlight">\(\pi\)</span> abbiamo solo un”<strong>approssimazione</strong>, l’algoritmo che calcola la
funzione <span class="math notranslate nohighlight">\(\sin(x)\)</span> propaga l’errore commesso nell’argomento anche sulla valutazione
restituendoci un errore finale dell’ordine della precisione di macchina.</p>
<p>D’altra parte, se usiamo la variante della funzione che lavora con i gradi,
osserviamo che</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">sind</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">180</span><span class="p">)</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">     </span><span class="mi">0</span><span class="w"></span>
</pre></div>
</div>
<p>questa volta l’input della funzione è un <strong>intero</strong>, per cui non commettiamo
errore di <strong>troncamento</strong> e otteniamo alla fine il valore esatto.</p>
</section>
<section id="associativita-delle-operazioni">
<h2>Associatività delle operazioni<a class="headerlink" href="#associativita-delle-operazioni" title="Link a questa intestazione">#</a></h2>
<p>Mentre l’operazione di somma e di prodotto sono garantite essere commutative
nello standard IEEE, l’operazione di soma tra <em>floating point</em> è sicuramente
non associativa. Si consideri infatti l’esempio:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1e-16</span><span class="p">;</span><span class="w"></span>
<span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-16</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1e-16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">  </span><span class="nb">logical</span><span class="w"></span>

<span class="w">   </span><span class="mi">0</span><span class="w"></span>
</pre></div>
</div>
<p>Si osserva che se andiamo a valutare la differenza tra le due procedure</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>

<span class="w">   </span><span class="mf">1.1102e-16</span><span class="w"></span>
</pre></div>
</div>
<p>che è di nuovo dell’ordine della precisione di macchina.</p>
<div class="admonition tip">
<p class="admonition-title">Suggerimento</p>
<p>Quando si calcola la somma di più termini di ordine diverso è opportuno valutare
l’accumulazione ed agire di conseguenza.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title">Precisione di stampa</p>
<p>È utile in alcuni casi aumentare la precisione delle stampe in uscita di
MATLAB, possiamo farlo per mezzo del comando <code class="docutils literal notranslate"><span class="pre">format</span></code>, in particolare:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">format</span><span class="w"> </span><span class="n">long</span><span class="w"></span>
</pre></div>
</div>
<p>farà in modo che l’output sia stampato con 15 cifre per una variabile
di tipo <code class="docutils literal notranslate"><span class="pre">double</span></code> e con 7 cifre per una variabile di tipo <code class="docutils literal notranslate"><span class="pre">single</span></code>. Per tornare
invece alla <em>notazione di default</em> si può usare il comando</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">format</span><span class="w"> </span><span class="n">short</span><span class="w"></span>
</pre></div>
</div>
<p>che userà invece 5 cifre indipendentemente per i due tipi di variabili. Altre
opzioni si possono leggere facendo <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">format</span></code>.</p>
<div class="admonition danger">
<p class="admonition-title">Pericolo</p>
<p>L’uso del comando <code class="docutils literal notranslate"><span class="pre">format</span></code> <strong>non</strong> altera la precisione in cui le operazioni
sono compiute, ma solo il formato di stampa a schermo.</p>
</div>
</aside>
<p>Per correggere il problema precedente si può implementare l”<strong>algoritmo delle somme
compensate</strong> di Kahan, per cui uno pseudocodice è dato da:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">KahanSomma</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="n">somma</span> <span class="o">=</span> <span class="mf">0.0</span>                  <span class="o">//</span> <span class="n">variabile</span> <span class="n">che</span> <span class="n">conterrà</span> <span class="n">la</span> <span class="n">somma</span> <span class="n">finale</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mf">0.0</span>                      <span class="o">//</span> <span class="n">Compensazione</span> <span class="n">per</span> <span class="n">i</span> <span class="n">bits</span> <span class="n">che</span> <span class="n">altrimenti</span> <span class="n">andrebbero</span> <span class="n">persi</span><span class="o">.</span>

    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">length</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span> <span class="n">do</span> <span class="o">//</span> <span class="n">L</span><span class="s1">&#39;array che ha in input le quantità da sommare va da input(1)</span>
                                   <span class="o">//</span> <span class="n">fino</span> <span class="n">a</span> <span class="nb">input</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span>           <span class="o">//</span> <span class="n">Al</span> <span class="n">primo</span> <span class="n">passaggio</span> <span class="n">c</span> <span class="n">è</span> <span class="n">zero</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">somma</span> <span class="o">+</span> <span class="n">y</span>              <span class="o">//</span> <span class="n">Purtroppo</span><span class="p">,</span> <span class="n">somma</span> <span class="n">è</span> <span class="s2">&quot;grande&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="n">è</span> <span class="n">piccolo</span><span class="p">,</span> <span class="n">quindi</span> <span class="n">alcuni</span> <span class="n">bits</span>
                                   <span class="o">//</span> <span class="n">sono</span> <span class="n">persi</span><span class="p">,</span> <span class="n">ma</span> <span class="n">non</span> <span class="n">per</span> <span class="n">sempre</span><span class="o">...</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">somma</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span>        <span class="o">//</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">somma</span><span class="p">)</span> <span class="n">cancella</span> <span class="n">la</span> <span class="n">parte</span> <span class="n">di</span> <span class="n">ordine</span> <span class="n">alto</span> <span class="n">di</span> <span class="n">y</span><span class="p">;</span> <span class="n">sottrarre</span> <span class="n">y</span>
                                   <span class="o">//</span> <span class="n">recupera</span> <span class="n">la</span> <span class="n">parte</span> <span class="s2">&quot;piccola&quot;</span> <span class="n">di</span> <span class="n">y</span>
        <span class="n">somma</span> <span class="o">=</span> <span class="n">t</span>                  <span class="o">//</span> <span class="n">In</span> <span class="n">aritmetica</span> <span class="n">di</span> <span class="n">precisione</span> <span class="n">infinita</span> <span class="n">c</span> <span class="n">dovrebbe</span> <span class="n">essere</span>
                                   <span class="o">//</span> <span class="n">sempre</span> <span class="n">zero</span>
    <span class="o">//</span> <span class="n">Alla</span> <span class="n">prossima</span> <span class="n">iterata</span> <span class="n">la</span> <span class="n">parte</span> <span class="s2">&quot;persa&quot;</span> <span class="n">verrà</span> <span class="n">aggiunta</span> <span class="n">ad</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">un</span> <span class="n">nuovo</span>
    <span class="o">//</span> <span class="n">tentativo</span> <span class="n">di</span> <span class="n">recuperarla</span><span class="o">.</span>
    <span class="n">end</span> <span class="k">for</span>

    <span class="k">return</span> <span class="n">somma</span>
</pre></div>
</div>
<div class="admonition-esercizio admonition">
<p class="admonition-title">Esercizio</p>
<p>Si implementi l’algoritmo KahanSomma in una funzione MATLAB e se ne verifichino
le proprietà numeriche.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>[somma]<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">KahanSomma</span><span class="p">(</span>input<span class="p">)</span><span class="w"></span>
<span class="c">%%KAHANSOMMA algoritmo delle somme compensate di Kahan</span><span class="w"></span>

<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<p>Che possiamo testare sull’esempio precedente costruendo uno script con</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">clear</span><span class="p">;</span><span class="w"> </span><span class="nb">clc</span><span class="p">;</span><span class="w"></span>

<span class="nb">input</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">1e-16</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="mf">1e-16</span><span class="p">];</span><span class="w"></span>

<span class="n">somma1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">input</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">input</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nb">input</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="n">somma2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="nb">input</span><span class="p">);</span><span class="w"></span>
<span class="n">somma3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">KahanSomma</span><span class="p">(</span><span class="nb">input</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>e confrontando la differenza in valore assoluto tra i tre valori <code class="docutils literal notranslate"><span class="pre">somma1</span></code>, <code class="docutils literal notranslate"><span class="pre">somma2</span></code>
e <code class="docutils literal notranslate"><span class="pre">somma3</span></code>. Cosa si osserva?</p>
</div>
<p>Per questo algoritmo è possibile dare una limitazione dell’errore commesso. Se chiamiamo</p>
<div class="math notranslate nohighlight">
\[S_n = \sum_{i=1}^{n} \text{input}_i\]</div>
<p>la somma calcolata in precisione infinita, allora con un algoritmo otteniamo in
genere <span class="math notranslate nohighlight">\(S_n + E_n\)</span> dove l’errore <span class="math notranslate nohighlight">\(E_n\)</span> può essere limitato per l’algoritmo delle somme
compensate da</p>
<div class="math notranslate nohighlight">
\[|E_n| \leq [2 \varepsilon + O(n\varepsilon^2)] \sum_{i=1}^{n} |\text{input}_i|,\]</div>
<p>dove <span class="math notranslate nohighlight">\(\varepsilon\)</span> è la precisione di macchina. Più in generale, siamo di solito
interessati all’errore relativo, cioè alla quantità</p>
<div class="math notranslate nohighlight">
\[\frac{|E_n|}{|S_n|} \leq [2 \varepsilon + O(n\varepsilon^2)] \frac{\sum_{i=1}^{n} |\text{input}_i|}{\left| \sum_{i=1}^{n} \text{input}_i| \right|},\]</div>
<aside class="margin sidebar">
<p class="sidebar-title">Numero di condizionamento</p>
<p>Ricordiamo che il numero di condizionamento di un problema rappresenta
essenzialmente la «sensitività» intrinseca del problema, indipendentemente
dall’algoritmo utilizzato per risolverlo.</p>
</aside>
<p>dove la quantità <span class="math notranslate nohighlight">\(\kappa = \frac{\sum_{i=1}^{n} |\text{input}_i|}{\left| \sum_{i=1}^{n} \text{input}_i| \right|}\)</span>
rappresenta il <strong>numero di condizionamento</strong> dell’operazione di somma. Esistono
algoritmi per la somma che esibiscono migliori limitazioni dell’errore <span id="id3">[<a class="reference internal" href="#id7" title="A. Klein. A generalized Kahan-Babuška-summation-algorithm. Computing, 76(3-4):279–293, 2006. URL: https://doi.org/10.1007/s00607-005-0139-x, doi:10.1007/s00607-005-0139-x.">Kle06</a>, <a class="reference internal" href="#id6" title="A. Neumaier. Rundungsfehleranalyse einiger Verfahren zur Summation endlicher Summen. Z. Angew. Math. Mech., 54:39–51, 1974. URL: https://doi.org/10.1002/zamm.19740540106, doi:10.1002/zamm.19740540106.">Neu74</a>]</span> , per i
nostri scopi illustrativi questa versione è sufficiente.</p>
</section>
<section id="errori-di-cancellazione-roundoff">
<h2>Errori di cancellazione/roundoff<a class="headerlink" href="#errori-di-cancellazione-roundoff" title="Link a questa intestazione">#</a></h2>
<p>Un altro caso in cui calcoli avventati possono avere effetti catastrofici è
quello delle sottrazioni eseguite con operandi quasi uguali, è facile che
l’annullamento si verifichi in modo imprevisto. Consideriamo l’esempio:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">1e-16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="nb">ans</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">     </span><span class="mi">0</span><span class="w"></span>
</pre></div>
</div>
<p>in cui osserviamo una <strong>cancellazione</strong> causata da <em>swamping</em>, che è un fenomeno
analogo a quello che abbiamo visto per l’associatività della somma. Stiamo
osservando una perdita di precisione che rende l’aggiunta insignificante.
È possibile introdurre delle correzioni algoritmiche in maniera analoga a quanto
fatto per la somma anche per altre funzioni, per corregere l’esempio visto sopra
possiamo usare la seguente riscrittura:</p>
<div class="math notranslate nohighlight">
\[\sqrt{1e-16 + 1} - 1 = \exp( \log(\sqrt{1e-16 + 1}) ) - 1 = \exp( 0.5 \log(1e-16 + 1) ) - 1,\]</div>
<p>ed usare le funzioni <code class="docutils literal notranslate"><span class="pre">expm1</span></code> e <code class="docutils literal notranslate"><span class="pre">log1p</span></code> di MATLAB che ci permettono di risolvere
il problema di cancellazione:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">expm1</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">log1p</span><span class="p">(</span><span class="mf">1e-16</span><span class="p">))</span><span class="w"></span>
</pre></div>
</div>
<p>in particolare</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">expm1</span></code> calcola <span class="math notranslate nohighlight">\(\exp(x)-1\)</span> compensando per il <em>roundoff</em> in <span class="math notranslate nohighlight">\(\exp(x)\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log1p</span></code> calcola <span class="math notranslate nohighlight">\(\log(1+x)\)</span> evitando di calcolare <span class="math notranslate nohighlight">\(1+x\)</span> per valori «piccoli»
di <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ul>
<aside class="margin sidebar">
<p class="sidebar-title">Roundoff polinomio</p>
<p><img alt="Roundoff nella valutazione di un polinomio" src="_images/polynomialroundoff.png" /></p>
</aside>
<p>Consideriamo un altro esempio, produciamo uno script che valuti il seguente
polinomio</p>
<div class="math notranslate nohighlight" id="equation-eq-polinomio">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-polinomio" title="Permalink a questa equazione">#</a></span>\[p(x) = x^7 - 7x^6 + 21x^5 -35x^4 +35x^3 - 21x^2 +7x -1,\]</div>
<p>nell’intervallo <span class="math notranslate nohighlight">\([0.988,1.012]\)</span> su di una griglia con scansione <span class="math notranslate nohighlight">\(10^{-4}\)</span>. Come
si vede dalla figura al margine questo produce il <em>plot</em> di una funzione che
non sembra proprio essere un polinomio: non è liscia! Stiamo osservando di nuovo
degli errori di <strong>roundoff</strong> dati dalla sottrazione di numeri dello stesso
ordine (elevato), che infatti (come si legge dalla scala sull’asse delle <span class="math notranslate nohighlight">\(y\)</span>)
hanno un ordine di <span class="math notranslate nohighlight">\(10^{-14}\)</span>. Se guardiamo meglio al polinomio in <a class="reference internal" href="#equation-eq-polinomio">(3)</a>
possiamo osservare che questo non è nient’altro che l’espansione di <span class="math notranslate nohighlight">\(p(x) = (x-1)^7\)</span>,
provate a fare un <em>plot</em> sullo stesso intervallo e confrontiamolo con il precedente</p>
<figure class="align-default" id="buonpolinomio">
<img alt="_images/polynomialroundoffgood.png" src="_images/polynomialroundoffgood.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Confronto del grafico del polinomio <a class="reference internal" href="#equation-eq-polinomio">(3)</a> calcolato nella forma <a class="reference internal" href="#equation-eq-polinomio">(3)</a>
e a partire dalla forma  <span class="math notranslate nohighlight">\(p(x) = (x-1)^7\)</span>.</span><a class="headerlink" href="#buonpolinomio" title="Link a questa immagine">#</a></p>
</figcaption>
</figure>
</section>
<section id="precisione-mista">
<h2>Precisione mista<a class="headerlink" href="#precisione-mista" title="Link a questa intestazione">#</a></h2>
<p>La rivoluzione delle applicazioni di «apprendimento automatico» (<em>machine learning</em>) e dell’intelligenza artificiale (<em>AI</em>) ha suscitato negli ultimi anni un interesse per lo sviluppo di aritmetica a <strong>mezza precisione</strong> (formato in virgola mobile a 16 bit) che potesse rispondere al problema della necessità di
avere alte prestazioni nelle fasi di addestramento delle reti neurali. L’idea
nasce dall’osservazione (per lo più empirica) che dice che la maggior parte di
queste applicazioni non richiede necessariamente l’accuratezza della precisione singola (<code class="docutils literal notranslate"><span class="pre">single</span></code>) o doppia (<code class="docutils literal notranslate"><span class="pre">double</span></code>). La mezza precisione (<code class="docutils literal notranslate"><span class="pre">half</span></code>) ha quindi
un’aritmetica più veloce e produce una riduzione della memoria e del traffico di un fattore <span class="math notranslate nohighlight">\(2\times\)</span> contro il formato  precisione in singola cifra e di un fattore <span class="math notranslate nohighlight">\(4\times\)</span> contro la doppia precisione.</p>
<p>In MATLAB questo è disponibile con il comando <code class="docutils literal notranslate"><span class="pre">half</span></code> per cui una buona parte delle
funzioni di default è resa disponibile. Si può interrogare l’inseme delle funzioni
disponibili con il comando:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">methods</span><span class="p">(</span><span class="n">half</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
</pre></div>
</div>
<p>che vi restituirà una lista del tipo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Methods</span> <span class="k">for</span> <span class="k">class</span> <span class="nc">half</span><span class="p">:</span>

<span class="nb">abs</span>         <span class="n">asinh</span>       <span class="nb">complex</span>     <span class="n">double</span>      <span class="n">floor</span>       <span class="n">int16</span>       <span class="n">islogical</span>   <span class="n">le</span>          <span class="n">logical</span>     <span class="n">mod</span>         <span class="n">plot3</span>       <span class="n">real</span>        <span class="n">scatter3</span>    <span class="n">subsasgn</span>    <span class="n">uint16</span>      <span class="n">ylim</span>        
<span class="n">acos</span>        <span class="n">atan</span>        <span class="n">conj</span>        <span class="n">end</span>         <span class="n">fplot</span>       <span class="n">int32</span>       <span class="n">isnan</span>       <span class="n">length</span>      <span class="n">lt</span>          <span class="n">mrdivide</span>    <span class="n">plotmatrix</span>  <span class="n">rem</span>         <span class="n">sin</span>         <span class="n">subsref</span>     <span class="n">uint32</span>      <span class="n">zlim</span>        
<span class="n">acosh</span>       <span class="n">atanh</span>       <span class="n">cos</span>         <span class="n">eps</span>         <span class="n">ge</span>          <span class="n">int64</span>       <span class="n">isnumeric</span>   <span class="n">line</span>        <span class="nb">max</span>         <span class="n">mtimes</span>      <span class="n">plus</span>        <span class="n">reshape</span>     <span class="n">single</span>      <span class="nb">sum</span>         <span class="n">uint64</span>      
<span class="nb">all</span>         <span class="n">bar</span>         <span class="n">cosh</span>        <span class="n">eq</span>          <span class="n">gt</span>          <span class="n">int8</span>        <span class="n">isreal</span>      <span class="n">log</span>         <span class="n">mean</span>        <span class="n">ndims</span>       <span class="n">pow10</span>       <span class="n">rgbplot</span>     <span class="n">sinh</span>        <span class="n">tan</span>         <span class="n">uint8</span>       
<span class="nb">any</span>         <span class="n">barh</span>        <span class="n">cospi</span>       <span class="n">exp</span>         <span class="n">half</span>        <span class="n">isempty</span>     <span class="n">isscalar</span>    <span class="n">log10</span>       <span class="nb">min</span>         <span class="n">ne</span>          <span class="n">pow2</span>        <span class="nb">round</span>       <span class="n">sinpi</span>       <span class="n">tanh</span>        <span class="n">uminus</span>      
<span class="n">area</span>        <span class="n">ceil</span>        <span class="n">ctranspose</span>  <span class="n">expm1</span>       <span class="n">hypot</span>       <span class="n">isfinite</span>    <span class="n">isvector</span>    <span class="n">log1p</span>       <span class="n">minus</span>       <span class="n">numel</span>       <span class="n">prod</span>        <span class="n">rsqrt</span>       <span class="n">size</span>        <span class="n">times</span>       <span class="n">uplus</span>       
<span class="n">asin</span>        <span class="n">colon</span>       <span class="n">display</span>     <span class="n">fix</span>         <span class="n">imag</span>        <span class="n">isinf</span>       <span class="n">ldivide</span>     <span class="n">log2</span>        <span class="n">mldivide</span>    <span class="n">plot</span>        <span class="n">rdivide</span>     <span class="n">scatter</span>     <span class="n">sqrt</span>        <span class="n">transpose</span>   <span class="n">xlim</span>   
</pre></div>
</div>
<p>Per estrarre <em>performance</em> dall’utilizzo della precisione <code class="docutils literal notranslate"><span class="pre">half</span></code> e, più in
generale, dall’utilizzo contemporaneo di dati in più precisioni (<em>mixed precision</em>) è necessario avere dell’hardware che possa lavorare in maniera
diretta in questo formato, cioè senza adoperare continuamente conversioni o simulare la precisione ridotta. Per le alte performance parliamo di oggetti come
le NVIDIA GPUs (CUDA Capabilitiy <span class="math notranslate nohighlight">\(\geq 7.0\)</span>), Google TPUs e diversi tipi di
FPGA più o meno sperimentali.</p>
<p>MATLAB ha un supporto limitato (ma in espansione) per lavorare sulle GPU, non
esploreremo oltre questa direzione, ma è utile che sappiate che esistono questi
possibili sviluppi.</p>
</section>
<section id="bibliografia">
<h2>Bibliografia<a class="headerlink" href="#bibliografia" title="Link a questa intestazione">#</a></h2>
<div class="docutils container" id="id4">
<dl class="citation">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id2">Hig02</a></span></dt>
<dd><p>Nicholas J. Higham. <em>Accuracy and stability of numerical algorithms</em>. Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA, second edition, 2002. ISBN 0-89871-521-0. URL: <a class="reference external" href="https://doi.org/10.1137/1.9780898718027">https://doi.org/10.1137/1.9780898718027</a>, <a class="reference external" href="https://doi.org/10.1137/1.9780898718027">doi:10.1137/1.9780898718027</a>.</p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id3">Kle06</a></span></dt>
<dd><p>A. Klein. A generalized Kahan-Babuška-summation-algorithm. <em>Computing</em>, 76(3-4):279–293, 2006. URL: <a class="reference external" href="https://doi.org/10.1007/s00607-005-0139-x">https://doi.org/10.1007/s00607-005-0139-x</a>, <a class="reference external" href="https://doi.org/10.1007/s00607-005-0139-x">doi:10.1007/s00607-005-0139-x</a>.</p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id3">Neu74</a></span></dt>
<dd><p>A. Neumaier. Rundungsfehleranalyse einiger Verfahren zur Summation endlicher Summen. <em>Z. Angew. Math. Mech.</em>, 54:39–51, 1974. URL: <a class="reference external" href="https://doi.org/10.1002/zamm.19740540106">https://doi.org/10.1002/zamm.19740540106</a>, <a class="reference external" href="https://doi.org/10.1002/zamm.19740540106">doi:10.1002/zamm.19740540106</a>.</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id1">IEEE75419</a></span></dt>
<dd><p>IEEE-754. <em>IEEE 754-2019, Standard for Floating-Point Arithmetic</em>. IEEE, New York, NY, USA, June 2019. ISBN 1-5044-5925-3 (print), 1-5044-5924-5 (e-PDF). URL: <a class="reference external" href="https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8766229">https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8766229</a>, <a class="reference external" href="https://doi.org/https://doi.org/10.1109/IEEESTD.2019.876622">doi:https://doi.org/10.1109/IEEESTD.2019.876622</a>.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="laboratorio2.html" title="precedente pagina">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">precedente</p>
            <p class="prev-next-title">Laboratorio 2 : Introduzione a MATLAB - II</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="laboratorio4.html" title="successivo pagina">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">successivo</p>
        <p class="prev-next-title">Laboratorio 4 : Il Metodo di Bisezione</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By F. Durastante<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>