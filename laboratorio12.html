
<!DOCTYPE html>

<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Laboratorio 12 : Metodi per la Soluzione di ODE &#8212; Calcolo Numerico - Esercitazioni di Laboratorio</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Indice" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="prev" title="Laboratorio 11 : Metodi di Quadratura" href="laboratorio11.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="it">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Calcolo Numerico - Esercitazioni di Laboratorio</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Calcolo Numerico - Esercitazioni di Laboratorio
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio1.html">
   Laboratorio 1 : Introduzione a MATLAB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio2.html">
   Laboratorio 2 : Introduzione a MATLAB - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio3.html">
   Laboratorio 3 : L’Aritmetica di Precisione Finita
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio4.html">
   Laboratorio 4 : Il Metodo di Bisezione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio5.html">
   Laboratorio 5 : Il Metodo di Newton
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio6.html">
   Laboratorio 6 : Soluzione dei Sistemi Lineari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio7.html">
   Laboratorio 7 : L’Eliminazione di Gauss il Metodo LU
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio8.html">
   Laboratorio 8 : Metodi Stazionari per Sistemi Lineari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio9.html">
   Laboratorio 9 : Metodi di Interpolazione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio10.html">
   Laboratorio 10 : Il Problema Lineare dei Minimi Quadrati
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio11.html">
   Laboratorio 11 : Metodi di Quadratura
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Laboratorio 12 : Metodi per la Soluzione di ODE
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Cirdans-Home/ingencn"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Cirdans-Home/ingencn/issues/new?title=Issue%20on%20page%20%2Flaboratorio12.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/laboratorio12.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problema-ai-valori-iniziali">
   Problema ai valori iniziali
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodi-numerici">
   Metodi numerici
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#il-metodo-di-eulero-esplicito">
     Il metodo di Eulero esplicito
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#il-metodo-di-eulero-implicito">
     Il metodo di Eulero implicito
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#esercizi">
   Esercizi
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Laboratorio 12 : Metodi per la Soluzione di ODE</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problema-ai-valori-iniziali">
   Problema ai valori iniziali
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodi-numerici">
   Metodi numerici
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#il-metodo-di-eulero-esplicito">
     Il metodo di Eulero esplicito
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#il-metodo-di-eulero-implicito">
     Il metodo di Eulero implicito
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#esercizi">
   Esercizi
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="laboratorio-12-metodi-per-la-soluzione-di-ode">
<h1>Laboratorio 12 : Metodi per la Soluzione di ODE<a class="headerlink" href="#laboratorio-12-metodi-per-la-soluzione-di-ode" title="Link a questa intestazione">#</a></h1>
<p>In questo laboratorio ci vogliamo occupare di alcuni metodi per la
soluzione di un”<strong>equazione differenziale del primo ordine</strong>, la cui forma
generale è</p>
<div class="math notranslate nohighlight">
\[y' = f(x,y)\]</div>
<p>dove <span class="math notranslate nohighlight">\(y' = {\rm d}y/{\rm d}x\)</span> e <span class="math notranslate nohighlight">\(f(x,y)\)</span> è una funzione data. Come avete
visto nei corsi di Analisi, la soluzione di questo tipo di equazioni
contiene una costante arbitraria (detta <em>costante di integrazione</em>). Per
trovare questa costante, e dunque determinare completamente una soluzione,
dobbiamo sapere un punto sulla curva della soluzione:</p>
<div class="math notranslate nohighlight">
\[y(a) = \alpha.\]</div>
<p>In modo <strong>più formale</strong>, un’<strong>equazione differenziale ordinaria di ordine <span class="math notranslate nohighlight">\(n\)</span></strong>, in <em>forma
normale</em>, è un’equazione del tipo</p>
<div class="math notranslate nohighlight">
\[y^{(n)}=f(x,y,y',y'',\ldots,y^{(n-1)}),\]</div>
<p>che lega una funzione <span class="math notranslate nohighlight">\(y=y(x)\)</span> e le sue derivate fino
all’ordine <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Soluzione dell’equazione è una funzione <span class="math notranslate nohighlight">\(y(x)\)</span>, continua e
derivabile fino all’ordine <span class="math notranslate nohighlight">\(n\)</span> in un intervallo opportuno, che
soddisfa l’equazione.</p>
<p>In generale, un’equazione differenziale ha infinite soluzioni.
Solitamente si impongono delle condizioni aggiuntive e si determinano
le soluzioni che soddisfano le condizioni assegnate.</p>
<section id="problema-ai-valori-iniziali">
<h2>Problema ai valori iniziali<a class="headerlink" href="#problema-ai-valori-iniziali" title="Link a questa intestazione">#</a></h2>
<p>Nel problema ai valori iniziali, detto anche di Cauchy, all’equazione</p>
<div class="math notranslate nohighlight">
\[y^{(n)}=f(x,y,y',y'',\ldots,y^{(n-1)}),\]</div>
<p>si assegnano <span class="math notranslate nohighlight">\(n\)</span> condizioni iniziali</p>
<div class="math notranslate nohighlight">
\[ y(x_0)=\eta_0,\quad y'(x_0)=\eta_1,\quad\ldots\quad,y^{(n-1)}(x_0)=\eta_{n-1}.\]</div>
<p>Sotto <strong>opportune condizioni</strong>, si dimostrano l’esistenza e l’unicità
della soluzione. In particolare, nel caso <span class="math notranslate nohighlight">\(n=1\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}    \left\{\begin{array}{l}
    y'=f(x,y)\quad\\y(x_0)=\eta
    \end{array}
    \right.\end{split}\]</div>
<p>valgono risultati di esistenza e unicità della soluzione nell’ipotesi
che <span class="math notranslate nohighlight">\(f(x,y)\)</span> sia continua rispetto a <span class="math notranslate nohighlight">\(x\)</span> e <em>uniformemente
lipschitziana</em> rispetto a <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>Più in generale, possiamo guardare ad un sistema <span class="math notranslate nohighlight">\(n\)</span> equazioni differenziali del primo ordine</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \left\{\begin{array}{l}
  y_1'=f_1(x,y_1,\ldots,y_n)\\
  y_2'=f_2(x,y_1,\ldots,y_n)\\
  \ldots\\
  y_n'=f_n(x,y_1,\ldots,y_n)\\
  \end{array}\right.\end{split}\]</div>
<p>dove <span class="math notranslate nohighlight">\(f_1,\ldots,f_n\)</span> sono <span class="math notranslate nohighlight">\(n\)</span> funzioni di <span class="math notranslate nohighlight">\(n+1\)</span>
variabili e <span class="math notranslate nohighlight">\(y_1(x), y_2(x),\ldots,y_n(x)\)</span> sono le <span class="math notranslate nohighlight">\(n\)</span> incognite.</p>
<p>In <strong>forma compatta</strong>:</p>
<div class="math notranslate nohighlight">
\[{\bf y}'={\bf f}(x,{\bf y}),\]</div>
<p>dove <span class="math notranslate nohighlight">\({\bf y}\)</span>, <span class="math notranslate nohighlight">\({\bf y}'\)</span> e <span class="math notranslate nohighlight">\({\bf f}\)</span> sono <em>vettori di funzioni</em>.</p>
<p>Se a questo sistema associamo le <strong>condizioni iniziali</strong></p>
<div class="math notranslate nohighlight">
\[{\bf y}(x_0)=(\eta_0,\eta_1,\ldots,\eta_{n-1})^T,\]</div>
<p>otteniamo il corrispondente problema ai valori iniziali, che, sotto
ipotesi simili a quelle già viste, ammette una e una sola soluzione.</p>
<div class="tip admonition">
<p class="admonition-title">Equazione differenziale <span class="math notranslate nohighlight">\(\leadsto\)</span> sistema di ordine 1</p>
<p>Data
un’equazione differenziale di ordine :math:<code class="docutils literal notranslate"><span class="pre">n</span></code></p>
<div class="math notranslate nohighlight">
\[y^{(n)}=f(x,y,y',y'',\ldots,y^{(n-1)}),\]</div>
<p>poniamo</p>
<div class="math notranslate nohighlight">
\[y_1(x)=y(x),\quad y_2(x)=y'(x),\quad\ldots\quad y_n(x)=y^{(n-1)}(x).\]</div>
<p>Allora l’equazione si trasforma in un sistema di equazioni del primo
ordine</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \left\{\begin{array}{l}
    y_1'=y_2\\
    y_2'=y_3\\
    \ldots\\
    y_{n-1}'=y_n\\
    y_n'=f(x,y_1,y_2,\ldots,y_n)
    \end{array}\right.\end{split}\]</div>
</div>
</section>
<section id="metodi-numerici">
<h2>Metodi numerici<a class="headerlink" href="#metodi-numerici" title="Link a questa intestazione">#</a></h2>
<p>Determinare la soluzione di un’equazione
differenziale per via analitica è generalmente difficile e spesso
impossibile. Per esempio, l’equazione</p>
<div class="math notranslate nohighlight">
\[y'=x^2+y^2,\]</div>
<p>nonostante l’aspetto apparentemente semplice, non è risolubile in
termini di funzioni elementari. Dobbiamo quindi cercare una soluzione
approssimata usando un metodo numerico.</p>
<p>La letteratura che tratta i metodi numerici per equazioni
differenziali con condizioni iniziali è molto vasta. Come primi
esempi studieremo</p>
<ul class="simple">
<li><p>il metodo di Eulero esplicito,</p></li>
<li><p>il metodi di Eulero implicito,</p></li>
<li><p>il metodo di Runge-Kutta classico.</p></li>
</ul>
<section id="il-metodo-di-eulero-esplicito">
<h3>Il metodo di Eulero esplicito<a class="headerlink" href="#il-metodo-di-eulero-esplicito" title="Link a questa intestazione">#</a></h3>
<p>Il metodo di Eulero esplicito Consideriamo il problema di Cauchy</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \left\{\begin{array}{l}
  y'=f(x,y)\\y(a)=\eta
  \end{array}
  \right.\end{split}\]</div>
<p>che vogliamo risolvere numericamente nell’intervallo <span class="math notranslate nohighlight">\([a,b]\)</span>
Discretizziamo la variabile <span class="math notranslate nohighlight">\(x\)</span> fissando nell’intervallo
<span class="math notranslate nohighlight">\([a,b]\)</span> una <strong>griglia di nodi</strong> <span class="math notranslate nohighlight">\(\{x_i\}_{i=0,\ldots,N}\)</span>
<strong>equidistanti</strong> di passo <span class="math notranslate nohighlight">\(h&gt;0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ x_0=a,\quad x_i=x_{i-1}+h,\quad x_N=b.\]</div>
<p>Il comportamento della soluzione
<span class="math notranslate nohighlight">\(y(x)\)</span> tra <span class="math notranslate nohighlight">\(x_{i-1}\)</span> e <span class="math notranslate nohighlight">\(x_{i}\)</span> può essere stimato come</p>
<div class="math notranslate nohighlight">
\[ y(x_{i})\sim y(x_{i-1})+hf(x_{i-1},y(x_{i-1})).\]</div>
<p>Per cui si
approssima la funzione <span class="math notranslate nohighlight">\(y(x)\)</span> per mezzo dei suoi valori
<span class="math notranslate nohighlight">\(y_i\)</span> nei nodi <span class="math notranslate nohighlight">\(x_i\)</span>, calcolati tramite la formula</p>
<div class="math notranslate nohighlight">
\[y_0=\eta,\quad y_i=y_{i-1}+hf(x_{i-1},y_{i-1}),\quad i=1,\ldots,N.\]</div>
<p>Abbiamo ora tutti gli strumenti necessari ad implementare il metodo di
Eulero esplicito.</p>
<div class="admonition-esercizio admonition">
<p class="admonition-title">Esercizio</p>
<p>Si usi il seguente prototipo per implementare il <strong>metodo di Eulero
esplicito</strong> per un sistema di equazioni differenziali del primo ordine.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>[y,x]<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">expliciteuler</span><span class="p">(</span>f,y0,a,b,h<span class="p">)</span><span class="w"></span>
<span class="c">%%EXPLICITEULER implementa il metodo di Eulero esplicito per la soluzione</span><span class="w"></span>
<span class="c">% di un sistema di equazioni differenziali del primo ordine.</span><span class="w"></span>
<span class="c">%   INPUT: f function handle della dinamica del sistema f(x,y)</span><span class="w"></span>
<span class="c">%          y0 vettore delle condizioni iniziali</span><span class="w"></span>
<span class="c">%          a,b estremi dell&#39;intervallo di integrazione</span><span class="w"></span>
<span class="c">%          h ampiezza del passo di integrazione</span><span class="w"></span>
<span class="c">%   OUTPUT: y vettore (matrice) che contiene le soluzioni calcolate nei</span><span class="w"></span>
<span class="c">%           punti x(i),</span><span class="w"></span>
<span class="c">%           x vettore dei nodi</span><span class="w"></span>

<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>Si verifichino gli <em>input</em>,</p></li>
<li><p>Si minimizzi il numero di chiamate alla funzione <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
</ul>
<p>Per testare il codice si può usare il seguente <strong>problema di test</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}  \left\{\begin{array}{l}
  y'=-\frac{2y+x^2y^2}{x}\\
  y(1)=1
  \end{array}\right.\end{split}\]</div>
<p>per <span class="math notranslate nohighlight">\(x\in [1,2]\)</span>. In questo caso la <strong>soluzione esatta</strong> è nota e vale</p>
<div class="math notranslate nohighlight">
\[y=\frac{1}{x^2(\log x+1)}.\]</div>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Il metodo di Eulero esplicito</span><span class="w"></span>
<span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">x</span>^<span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span>^<span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="n">ytrue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="o">.*</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>

<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="n">h</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span><span class="w"></span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">expliciteuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">h</span><span class="p">);</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;r--&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">ytrue</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Computed Solution&#39;</span><span class="p">,</span><span class="s">&#39;True Solution&#39;</span><span class="p">},</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span><span class="w"></span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">ytrue</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Errore Assoluto&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<p>Possiamo studiare la convergenza del metodo guardando all’errore rispetto
alla soluzione esatta e sfruttando la <em>function</em> <code class="docutils literal notranslate"><span class="pre">convergenza2</span></code> che
abbiamo visto quando abbiamo discusso del metodo di Newton (<a class="reference internal" href="laboratorio5.html#newt-convergenza"><span class="std std-ref">Convergenza</span></a>)
per stimare numericamente l’ordine di convergenza:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>q<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">convergenza2</span><span class="p">(</span>x<span class="p">)</span><span class="w"></span>
<span class="c">%%CONVERGENZA produce una stima dell&#39;ordine di convergenza della</span><span class="w"></span>
<span class="c">%%successione x_n ad xtrue.</span><span class="w"></span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3</span><span class="p">:(</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">q</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">real</span><span class="p">(</span><span class="nb">log</span><span class="p">((</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="o">/</span><span class="nb">log</span><span class="p">((</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">))));</span><span class="w">       </span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<p>Con questa osserviamo che:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Convergenza</span><span class="w"></span>
<span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fliplr</span><span class="p">(</span><span class="nb">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">));</span><span class="w"></span>
<span class="n">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">expliciteuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">yt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">err</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">norm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yt</span><span class="p">)</span><span class="o">/</span><span class="nb">norm</span><span class="p">(</span><span class="n">yt</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="nb">loglog</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="s">&#39;o-&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">)</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Errore Assoluto&#39;</span><span class="p">);</span><span class="w"></span>

<span class="n">q</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">convergenza2</span><span class="p">(</span><span class="n">err</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<figure class="align-default" id="id1">
<img alt="_images/forward_euler_error.png" src="_images/forward_euler_error.png" />
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">Errore del metodo di Eulero in avanti.</span><a class="headerlink" href="#id1" title="Link a questa immagine">#</a></p>
</figcaption>
</figure>
<p>ed il valore di <span class="math notranslate nohighlight">\(q = [0.9784, 0.9972, 1.0000, 1.0001, 1.0000, 1.0000]\)</span> ed
il previsto ordine di convergenza per questo metodo.</p>
<p>Infatti, se supponiamo che <span class="math notranslate nohighlight">\(f(x,y)\)</span> abbia derivate continue rispetto a
<span class="math notranslate nohighlight">\(x\)</span> e <span class="math notranslate nohighlight">\(y\)</span>. In questo caso si ha <span class="math notranslate nohighlight">\(y(x)\in\mathcal{C}^2([a,b])\)</span>. Possiamo
quindi applicare la formula di Taylor (con resto in forma di Lagrange):</p>
<div class="math notranslate nohighlight">
\[y(x_i)-y(x_{i-1})=hy'(x_{i-1})+\frac{h^2}{2}y''(\xi),\quad \xi\in (x_{i-1},x_i)\]</div>
<p>da cui si deduce</p>
<div class="math notranslate nohighlight">
\[|\tau_i|=\frac{h}{2}|y''(\xi)|.\]</div>
<p>Quindi in ogni intervallo <span class="math notranslate nohighlight">\([x_{i-1},x_i]\)</span> l’<strong>errore locale</strong> è
approssimativamente lineare in <span class="math notranslate nohighlight">\(h\)</span>. Poiché <span class="math notranslate nohighlight">\(|y''(\xi)|\)</span> è
limitato in <span class="math notranslate nohighlight">\([a,b]\)</span>, si ha che <span class="math notranslate nohighlight">\(\tau_i\)</span> tende a zero con
<span class="math notranslate nohighlight">\(h\)</span> e si scrive <span class="math notranslate nohighlight">\(\tau_i=\mathcal{O}(h)\)</span>.</p>
<p>Posto <span class="math notranslate nohighlight">\(\tau=\max_{i=1,\ldots,N}|\tau_i|\)</span>, esiste una costante
<span class="math notranslate nohighlight">\(M\neq 0\)</span> per cui <span class="math notranslate nohighlight">\(\tau\leq Mh\)</span>, e quindi</p>
<div class="math notranslate nohighlight">
\[ \lim_{h\rightarrow 0}\tau=0,\qquad \tau=\mathcal{O}(h).\]</div>
<p>Si dice allora che il metodo di Eulero è consistente di ordine 1.</p>
<p>Si può dimostrare che, sotto le stesse ipotesi su <span class="math notranslate nohighlight">\(f\)</span>, anche
l’errore globale tende a zero con <span class="math notranslate nohighlight">\(h\rightarrow 0\)</span>. Concludiamo
quindi che il metodo di Eulero è convergente.</p>
<p>Proviamo ora a <strong>cambiare le condizioni iniziali</strong> per la nostra ODE.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{\begin{array}{l}
y'=-\frac{2y+x^2y^2}{x}\\
y(1)=10
\end{array}\right.,\quad x\in [1,2].\end{split}\]</div>
<p>La soluzione generale è data da</p>
<div class="math notranslate nohighlight">
\[y(x) = \frac{1}{x^2 (c_1+\log (x))}\]</div>
<p>e sostituendo la condizione iniziale</p>
<div class="math notranslate nohighlight">
\[y(x) = \frac{10}{x^2 (10 \log (x)+1)}.\]</div>
<p>Tuttavia se ripetiamo l’analisi di convergenza</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Convergenza per diverse condizioni iniziali</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>

<span class="n">ytrue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="mi">10</span><span class="o">./</span><span class="p">(</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="o">.*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>

<span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fliplr</span><span class="p">(</span><span class="nb">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">));</span><span class="w"></span>
<span class="n">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">expliciteuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">yt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">err</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">norm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yt</span><span class="p">)</span><span class="o">/</span><span class="nb">norm</span><span class="p">(</span><span class="n">yt</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="nb">loglog</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="s">&#39;o-&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">)</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Errore Assoluto&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Osserviamo:</p>
<figure class="align-default" id="id2">
<img alt="_images/forward_euler_error2.png" src="_images/forward_euler_error2.png" />
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">Convergenza del metodo di Eulero per diverse condizioni iniziali.</span><a class="headerlink" href="#id2" title="Link a questa immagine">#</a></p>
</figcaption>
</figure>
<p>Quello che vediamo è che per il valore di <span class="math notranslate nohighlight">\(h\)</span> più grande, ovvero <span class="math notranslate nohighlight">\(h =
0.1\)</span>, l’errore relativo è maggiore di <span class="math notranslate nohighlight">\(1\)</span>, cioè <strong>non abbiamo
convergenza</strong>. Nell’esempio il metodo di Eulero ha quindi un
comportamento instabile.</p>
<p>La stabilità di un metodo numerico per problemi differenziali viene
valutata applicando il metodo ad un particolare problema test ed
esaminando se l’errore, introdotto ad un passo per effetto del
calcolo, aumenta o diminuisce quando viene propagato al passo
successivo.</p>
<p>Nel caso generale del problema</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \left\{\begin{array}{l}
  y'=f(x,y)\\y(a)=\eta
  \end{array}
  \right.\end{split}\]</div>
<p>la limitazione sul passo <span class="math notranslate nohighlight">\(h\)</span> diventa</p>
<div class="math notranslate nohighlight">
\[0&lt;h&lt;\frac{2}{|f_y(x,y)|}\]</div>
<p>e quindi cambia punto per punto. Nell’esempio con <span class="math notranslate nohighlight">\(f(x,y)=-\frac{2y+x^2y^2}{x}\)</span> e condizione iniziale <span class="math notranslate nohighlight">\(y(1)=1\)</span> si ha</p>
<div class="math notranslate nohighlight">
\[f_y(x,y)=-2\,\frac{1+x^2y}{x},\quad f_y(x_0,y_0)=f_y(1,1)=-4.\]</div>
<p>Perciò al primo passo il metodo di Eulero è stabile per
<span class="math notranslate nohighlight">\(0&lt;h&lt;1/2\)</span>; questa proprietà vale anche ai passi successivi
perché si ha <span class="math notranslate nohighlight">\(|f_y(x_i,y_i)|&lt;|f_y(x_0,y_0)|\)</span> e <span class="math notranslate nohighlight">\(i&gt;1\)</span>.</p>
<p>Quando invece si modifica la condizione iniziale si ha</p>
<div class="math notranslate nohighlight">
\[f_y(x_0,u_0)=f_y(1,10)=-22,\]</div>
<p>quindi per avere stabilità si richiede <span class="math notranslate nohighlight">\(0&lt;h&lt;1/11\)</span> al primo
passo. Ai passi successivi, vista la decrescenza della soluzione,
questa limitazione risulta indebolita e si può scegliere un valore di
<span class="math notranslate nohighlight">\(h\)</span> un più grande e questo è ben descritto dalla figura.</p>
</section>
<section id="il-metodo-di-eulero-implicito">
<h3>Il metodo di Eulero implicito<a class="headerlink" href="#il-metodo-di-eulero-implicito" title="Link a questa intestazione">#</a></h3>
<p>Da quanto detto finora sembra
che scelte piccole del passo <span class="math notranslate nohighlight">\(h\)</span> siano indispensabili per
assicurare convergenza e stabilità. Tuttavia, a un <span class="math notranslate nohighlight">\(h\)</span> piccolo
corrisponde un numero elevato di nodi di integrazione, e
quindi un notevole volume di calcolo per approssimare la soluzione in
tutto l’intervallo richiesto, con un conseguente elevato accumulo
dell’errore di arrotondamento.</p>
<p>La scelta di <span class="math notranslate nohighlight">\(h\)</span> deve quindi trovare un <strong>compromesso</strong> tra due
esigenze: passo sufficientemente piccolo per ragioni di convergenza e
stabilità, ma al contempo non troppo piccolo per non rendere
eccessivo l’errore di arrotondamento.</p>
<p>Per ridurre le richieste su <span class="math notranslate nohighlight">\(h\)</span>, introduciamo quindi i metodi impliciti.</p>
<div class="admonition-esercizio admonition">
<p class="admonition-title">Esercizio</p>
<p>Si implementi il metodo di Eulero implicito.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>[y,x]<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">impliciteuler</span><span class="p">(</span>f,y0,a,b,h<span class="p">)</span><span class="w"></span>
<span class="c">%%IMPLICITEULER implementa il metodo di Eulero implicito per la soluzione</span><span class="w"></span>
<span class="c">% di un sistema di equazioni differenziali del primo ordine.</span><span class="w"></span>
<span class="c">%   INPUT: f function handle della dinamica del sistema f(x,y)</span><span class="w"></span>
<span class="c">%          y0 vettore delle condizioni iniziali</span><span class="w"></span>
<span class="c">%          a,b estremi dell&#39;intervallo di integrazione</span><span class="w"></span>
<span class="c">%          h ampiezza del passo di integrazione</span><span class="w"></span>
<span class="c">%   OUTPUT: y vettore (matrice) che contiene le soluzioni calcolate nei</span><span class="w"></span>
<span class="c">%           punti x(i),</span><span class="w"></span>
<span class="c">%           x vettore dei nodi</span><span class="w"></span>

<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>Si usi il comando <code class="docutils literal notranslate"><span class="pre">fsolve</span></code> per risolvere il sistema (possibilmente) non
lineare, per sopprimere le stampe di controllo di <code class="docutils literal notranslate"><span class="pre">fsolve</span></code> si possono
usare le opzioni generate con <code class="docutils literal notranslate"><span class="pre">optimoptions('fsolve','Display','none')</span></code>.</p></li>
</ul>
<p>Per verificare l’implementazione possiamo usare lo stesso problema test</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Il metodo di Eulero implicito</span><span class="w"></span>
<span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">x</span>^<span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span>^<span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="n">ytrue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="o">.*</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>

<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="n">h</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span><span class="w"></span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">impliciteuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">h</span><span class="p">);</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;r--&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">ytrue</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Computed Solution&#39;</span><span class="p">,</span><span class="s">&#39;True Solution&#39;</span><span class="p">},</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span><span class="w"></span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">ytrue</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Errore Assoluto&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<p>Controlliamo ora che succede nel caso che prima ci restituiva dei
problemi confrontando la soluzione con il metodo di Eulero esplicito
ed implicito.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Errore di stabilità</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="n">h</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-1</span><span class="p">;</span><span class="w"></span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>

<span class="n">ytrue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="mi">10</span><span class="o">./</span><span class="p">(</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="o">.*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>

<span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">impliciteuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">h</span><span class="p">);</span><span class="w"></span>
<span class="p">[</span><span class="n">yexp</span><span class="p">,</span><span class="n">xexp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">expliciteuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">h</span><span class="p">);</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;r--&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">ytrue</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Computed Solution&#39;</span><span class="p">,</span><span class="s">&#39;True Solution&#39;</span><span class="p">},</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Eulero implicito&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">xexp</span><span class="p">,</span><span class="n">yexp</span><span class="p">,</span><span class="s">&#39;r--&#39;</span><span class="p">,</span><span class="n">xexp</span><span class="p">,</span><span class="n">ytrue</span><span class="p">(</span><span class="n">xexp</span><span class="p">),</span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Computed Solution&#39;</span><span class="p">,</span><span class="s">&#39;True Solution&#39;</span><span class="p">},</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Eulero esplicito&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<figure class="align-default" id="id3">
<img alt="_images/implicit_euler_error.png" src="_images/implicit_euler_error.png" />
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">Differenza in stabilità tra il metodo di Eulero implicito ed esplicito.</span><a class="headerlink" href="#id3" title="Link a questa immagine">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="esercizi">
<h2>Esercizi<a class="headerlink" href="#esercizi" title="Link a questa intestazione">#</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title">Condizione iniziale</p>
<figure class="align-default" id="fig-spacecraft">
<img alt="_images/spacecraft.png" src="_images/spacecraft.png" />
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Condizioni iniziali</span><a class="headerlink" href="#fig-spacecraft" title="Link a questa immagine">#</a></p>
</figcaption>
</figure>
</aside>
<div class="admonition-esercizio admonition">
<p class="admonition-title">Esercizio</p>
<p>Un veicolo spaziale è lanciato ad una altitudine di <span class="math notranslate nohighlight">\(H = 772 \text{ km}\)</span>
sul livello del mare con velocità iniziale <span class="math notranslate nohighlight">\(v_0 = 6700\,\text{m/s}\)</span> nella
direzione illustrata in <a class="reference internal" href="#fig-spacecraft"><span class="std std-numref">Fig. 22</span></a>. Le equazioni differenziali che descrivono
il moto dell’oggetto in coordinate polari sono</p>
<div class="math notranslate nohighlight">
\[\ddot{r} = r \dot{\theta}^2 - \frac{G M_e}{r^2}, \quad \ddot{\theta} = - 2 \frac{\dot{r}\dot{\theta}}{r}.\]</div>
<p>Rispetto alle costanti</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(G = 6.672 \times 10^{-11}\)</span> <span class="math notranslate nohighlight">\(\text{m}^3\text{kg}^{-1}\text{s}^{-2}\)</span> per la costante di gravitazione universale,</p></li>
<li><p><span class="math notranslate nohighlight">\(M_e = 5.9742 \times 10^{24} \text{ kg}\)</span>, per la massa della terra,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_e = 6378.14 \text{ km}\)</span> per il raggio della terra a livello del mare,</p></li>
</ul>
<p>Si ottengano le equazioni differenziali del <strong>primo ordine</strong> per questo
sistema e si integri numericamente fino a che il veicolo non tocca terra.
Si determini il valore di <span class="math notranslate nohighlight">\(\theta\)</span> del sito di impatto.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Suggerimento</p>
<p>Si può usare il seguente prototipo per implementare la dinamica. In questa
implementazione assumiamo di aver ordinato le variabili <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> del sistema riscritto al primo ordine come <span class="math notranslate nohighlight">\(\mathbf{y} = [y_1,y_2,y_3,y_4]^T = [r,\dot{r},\theta,\dot{\theta}]^T\)</span>.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>ydot<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">veicolo</span><span class="p">(</span>x,y<span class="p">)</span><span class="w"></span>
<span class="c">%VEICOLO Dinamica per il veicolo in coordinate polari.</span><span class="w"></span>
<span class="c">%   INPUT:  x variabile muta</span><span class="w"></span>
<span class="c">%           y vettore delle variabili y = [r rdot theta thetadot]</span><span class="w"></span>
<span class="c">%   OUTPUT: dinamica del sistema</span><span class="w"></span>

<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="admonition-esercizio admonition">
<p class="admonition-title">Esercizio</p>
<p>Un paracadutista di massa <span class="math notranslate nohighlight">\(m\)</span> in caduta libera verticale subisce una
resistenza aerodinamica <span class="math notranslate nohighlight">\(F_D = c_D \dot{y}^2\)</span>, dove <span class="math notranslate nohighlight">\(y\)</span> è misurata
verso il basso dall’inizio della caduta. L’equazione differenziale che descrive la caduta è</p>
<div class="math notranslate nohighlight">
\[\ddot{y} = g - \frac{c_D}{m} \dot{y}^2.\]</div>
<p>Si determnini il tempo di una caduta di <span class="math notranslate nohighlight">\(500 \text{ m}\)</span> utilizzando
<span class="math notranslate nohighlight">\(g = 9.80665 \text{ m/}\text{s}^2\)</span>, <span class="math notranslate nohighlight">\(c_D = 0.2028 \text{ kg/m}\)</span> e
<span class="math notranslate nohighlight">\(m = 80 \,\text{kg}\)</span>.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="laboratorio11.html" title="precedente pagina">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">precedente</p>
            <p class="prev-next-title">Laboratorio 11 : Metodi di Quadratura</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By F. Durastante, C. Pagliantini<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>