
<!DOCTYPE html>

<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Laboratorio 11b: Metodi Multistep Lineari &#8212; Calcolo Numerico - Esercitazioni di Laboratorio</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Indice" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="prev" title="Laboratorio 11 : Metodi per la Soluzione di ODE" href="laboratorio12.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="it">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Calcolo Numerico - Esercitazioni di Laboratorio</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Calcolo Numerico - Esercitazioni di Laboratorio
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio1.html">
   Laboratorio 1 : Introduzione a MATLAB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio2.html">
   Laboratorio 2 : Introduzione a MATLAB - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio3.html">
   Laboratorio 3 : L’Aritmetica di Precisione Finita
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio4.html">
   Laboratorio 4 e 5: Metodi di Interpolazione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio5.html">
   Laboratorio 6 : Metodi di Quadratura
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio6.html">
   Laboratorio 7a : Soluzione di Sistemi Lineari Triangolari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio7.html">
   Laboratorio 7b : Il Metodo di Eliminazione di Gauss e la Fattorizzazione LU
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio8.html">
   Laboratorio 8 : Il Problema Lineare dei Minimi Quadrati
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio9.html">
   Laboratorio 9 : Metodi Iterativi Stazionari per Sistemi Lineari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio10.html">
   Laboratorio 10a : Il Metodo di Bisezione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio11.html">
   Laboratorio 10b : Il Metodo di Newton
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laboratorio12.html">
   Laboratorio 11 : Metodi per la Soluzione di ODE
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Laboratorio 11b: Metodi Multistep Lineari
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Cirdans-Home/ingencn"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Cirdans-Home/ingencn/issues/new?title=Issue%20on%20page%20%2Flaboratorio14.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/laboratorio14.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problema-ai-valori-iniziali">
   Problema ai Valori Iniziali
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodi-multistep-lineari">
   Metodi Multistep Lineari
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basi-di-lagrange-su-punti-equispaziati">
     Basi di Lagrange su punti equispaziati
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#base-l-1-t">
     Base
     <span class="math notranslate nohighlight">
      \(L_{-1}(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#base-l-0-t">
     Base
     <span class="math notranslate nohighlight">
      \(L_0(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Base
     <span class="math notranslate nohighlight">
      \(L_1(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#riepilogo-delle-basi-di-lagrange">
     Riepilogo delle Basi di Lagrange
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adams-bashforth-esplicito">
     Adams-Bashforth (Esplicito)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adams-moulton-implicito">
     Adams-Moulton (Implicito)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bdf-di-ordine-2">
     BDF di ordine 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementazione">
   Implementazione
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#metodo-di-adams-bashforth">
     Metodo di Adams-Bashforth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#metodo-di-adams-moulton">
     Metodo di Adams-Moulton
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     BDF di ordine 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problema-di-test">
     Problema di Test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analisi-della-convergenza">
   Analisi della Convergenza
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Laboratorio 11b: Metodi Multistep Lineari</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problema-ai-valori-iniziali">
   Problema ai Valori Iniziali
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodi-multistep-lineari">
   Metodi Multistep Lineari
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basi-di-lagrange-su-punti-equispaziati">
     Basi di Lagrange su punti equispaziati
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#base-l-1-t">
     Base
     <span class="math notranslate nohighlight">
      \(L_{-1}(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#base-l-0-t">
     Base
     <span class="math notranslate nohighlight">
      \(L_0(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Base
     <span class="math notranslate nohighlight">
      \(L_1(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#riepilogo-delle-basi-di-lagrange">
     Riepilogo delle Basi di Lagrange
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adams-bashforth-esplicito">
     Adams-Bashforth (Esplicito)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adams-moulton-implicito">
     Adams-Moulton (Implicito)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bdf-di-ordine-2">
     BDF di ordine 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementazione">
   Implementazione
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#metodo-di-adams-bashforth">
     Metodo di Adams-Bashforth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#metodo-di-adams-moulton">
     Metodo di Adams-Moulton
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     BDF di ordine 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problema-di-test">
     Problema di Test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analisi-della-convergenza">
   Analisi della Convergenza
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="laboratorio-11b-metodi-multistep-lineari">
<h1>Laboratorio 11b: Metodi Multistep Lineari<a class="headerlink" href="#laboratorio-11b-metodi-multistep-lineari" title="Link a questa intestazione">#</a></h1>
<p>In questo laboratorio esploreremo i metodi multistep lineari per la risoluzione di equazioni differenziali ordinarie (ODE). Questi metodi, a differenza dei metodi single-step che utilizzano informazioni solo dall’intervallo attuale, sfruttano più intervalli precedenti per calcolare la soluzione. Vedremo la costruzione e l’implementazione di alcuni metodi multistep lineari e confronteremo la loro efficacia rispetto ai metodi di ordine inferiore.</p>
<section id="problema-ai-valori-iniziali">
<h2>Problema ai Valori Iniziali<a class="headerlink" href="#problema-ai-valori-iniziali" title="Link a questa intestazione">#</a></h2>
<p>Consideriamo un problema ai valori iniziali per una equazione differenziale del primo ordine</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
y'(t)=f(t,y(t))\\
y(t_0)=y_0
\end{cases}\end{split}\]</div>
</section>
<section id="metodi-multistep-lineari">
<h2>Metodi Multistep Lineari<a class="headerlink" href="#metodi-multistep-lineari" title="Link a questa intestazione">#</a></h2>
<p>Un metodo multistep lineare utilizza più punti precedenti per stimare la soluzione nel punto successivo. In generale, un metodo a <span class="math notranslate nohighlight">\(p+1\)</span> passi può essere scritto come:</p>
<div class="math notranslate nohighlight">
\[y_{n+1} = \sum_{j=0}^{p} a_j y_{n-j} + h \sum_{j=0}^{p} b_j f_{n-j} + h b_{-1} f_{n+1}, \quad n = p, p+1, \ldots\]</div>
<p>dove <span class="math notranslate nohighlight">\(a_i\)</span> e <span class="math notranslate nohighlight">\(b_i\)</span> sono i coefficienti del metodo e <span class="math notranslate nohighlight">\(h\)</span> è il passo di integrazione. Si noti che, in generale, se <span class="math notranslate nohighlight">\(b_{-1}\)</span> è diverso da zero, il metodo è implicito, altrimenti il metodo è esplicito.</p>
<p>Un modo semplice per costruire metodi multi-step automaticamente consistenti e di alto ordine è sfruttare l’interpolazione polinomiale, nella formulazione differenziale del problema di Cauchy o nella sua forma integrale, ovvero, indicando con <span class="math notranslate nohighlight">\(I(y)\)</span> o <span class="math notranslate nohighlight">\(I(f)\)</span> una opportuna interpolazione polinomiale di grado <span class="math notranslate nohighlight">\(k\leq p+1\)</span> della funzione <span class="math notranslate nohighlight">\(y\)</span> o della funzione <span class="math notranslate nohighlight">\(f\)</span>, i seguenti metodi numerici multi-step sono automaticamente di ordine di consistenza almeno <span class="math notranslate nohighlight">\(k\)</span>:</p>
<div class="math notranslate nohighlight">
\[(I(y))'(t_{n+1}) = f(t_{n+1}, y_{n+1})\]</div>
<p>Scegliendo i punti di interpolazione tra i punti <span class="math notranslate nohighlight">\(y_{n-p}, ..., y_{n}, y_{n+1}\)</span>, calcolando la derivata della funzione interpolatrice e riordinando i termini si ottengono dei metodi della famiglia descritta sopra con <span class="math notranslate nohighlight">\(b_{-1}=1\)</span> e <span class="math notranslate nohighlight">\(b_i = 0, i\ge 0\)</span>. I metodi BDF (<em>Backward Differentiation Formula</em>) sono un caso speciale di questi dove si utilizzano tutti i <span class="math notranslate nohighlight">\(p+2\)</span> punti <span class="math notranslate nohighlight">\(y_{n-p}, ..., y_{n}, y_{n+1}\)</span> per costruire un polinomio interpolatore di ordine <span class="math notranslate nohighlight">\(p+1\)</span>.</p>
<p>Usando invece la formulazione integrale</p>
<div class="math notranslate nohighlight">
\[y_{n+1} = y_{n-s} + \int_{t_{n-s}}^{t_{n+1}} I(f)\]</div>
<p>con <span class="math notranslate nohighlight">\(0\leq s\leq p\)</span> e scegliendo i punti di interpolazione tra i punti <span class="math notranslate nohighlight">\(f(t_{n-p}, y_{n-p}), ..., f(t_{n}, y_{n}), f(t_{n+1}, y_{n+1})\)</span> si ottengono metodi multistep dove solo il coefficiente <span class="math notranslate nohighlight">\(a_s = 1\)</span> è <span class="math notranslate nohighlight">\(\neq 0\)</span>, e i coefficienti <span class="math notranslate nohighlight">\(b_i\)</span> sono in generale diversi da zero, e coincidono con i pesi di quadratura (ovvero con l’integrale delle basi di Lagrange legate ai punti di interpolazione scelti per <span class="math notranslate nohighlight">\(f\)</span>).</p>
<p>I metodi di Adams-Bashfort (Espliciti) o Adams-Multon (Impliciti), sono costruiti con una interpolazione polinomiale su tutti i punti <span class="math notranslate nohighlight">\(f(t_{n-p}, y_{n-p}), ..., f(t_{n}, y_{n})\)</span> (Adams-Bashfort), o includendo anche  <span class="math notranslate nohighlight">\(f(t_{n+1}, y_{n+1})\)</span> (Adams-Multon), e calcolando l’integrale tra <span class="math notranslate nohighlight">\(t_n\)</span> e <span class="math notranslate nohighlight">\(t_{n+1}\)</span> (<span class="math notranslate nohighlight">\(s=0\)</span> nella formula sopra).</p>
<p>Si noti che nei metodi di Adams di ordine <span class="math notranslate nohighlight">\(\gt 2\)</span>, l’intervallo di integrazione è sempre <span class="math notranslate nohighlight">\((t_n, t_{n+1})\)</span>, ma il polinomio di interpolazione è calcolato anche usando punti esterni all’intervallo <span class="math notranslate nohighlight">\((t_n, t_{n+1})\)</span>.</p>
<p>Un caso speciale che non rientra nei metodi qui sopra descritti, ma che è spesso usato, è dato scegliendo <span class="math notranslate nohighlight">\(p=1\)</span>, e <span class="math notranslate nohighlight">\(k=0\)</span>, e usando come punto di di interpolazione <span class="math notranslate nohighlight">\(f_n\)</span>:</p>
<div class="math notranslate nohighlight">
\[y_{n+1} = y_{n-1} + 2 h f(t_n, y_n)\]</div>
<p>In questo caso si utilizza la formula del punto medio per approssimare l’integrale, ovvero si considera <span class="math notranslate nohighlight">\(I(f)\)</span> costante, con punto di interpolazione scelto nel mezzo dell’intervallo <span class="math notranslate nohighlight">\(t_{n-1}, t_{n+1}\)</span>. Questa scelta garantisce che l’integrale sia esatto per funzioni lineari, risultante in un metodo di ordine due.</p>
<section id="basi-di-lagrange-su-punti-equispaziati">
<h3>Basi di Lagrange su punti equispaziati<a class="headerlink" href="#basi-di-lagrange-su-punti-equispaziati" title="Link a questa intestazione">#</a></h3>
<p>Le basi di Lagrange su punti a distanza <span class="math notranslate nohighlight">\(h\)</span> tra loro possono essere espresse in modo esplicito.</p>
<p>Consideriamo <span class="math notranslate nohighlight">\(p+2\)</span> punti equispaziati <span class="math notranslate nohighlight">\(t_{-p}, t_{-p+1}, \ldots, t_0, t_1 \)</span>con una distanza <span class="math notranslate nohighlight">\(h\)</span> tra loro. Questi punti sono dati da:</p>
<div class="math notranslate nohighlight">
\[
t_i = ih \quad \text{per} \quad i = -p, -p+1, \ldots, 0, 1
\]</div>
<p>Vogliamo derivare le basi di Lagrange per questi punti. La base di Lagrange <span class="math notranslate nohighlight">\(L_j(t)\)</span> per il punto <span class="math notranslate nohighlight">\(t_j = jh\)</span> è data dalla formula generale:
$<span class="math notranslate nohighlight">\(
L_j(t) = \prod_{\substack{-p \le m \le 1 \\ m \ne j}} \frac{t - mh}{jh - mh}
\)</span>$</p>
<p>Poiché <span class="math notranslate nohighlight">\(jh - mh = (j - m)h\)</span>, possiamo semplificare la formula come segue:
$<span class="math notranslate nohighlight">\(
L_j(t) = \prod_{\substack{-p \le m \le 1 \\ m \ne j}} \frac{t - mh}{(j - m)h} = \prod_{\substack{-p \le m \le 1 \\ m \ne j}} \frac{\frac{t}{h} - m}{j - m}
\)</span>$</p>
<p>Questa è la forma esplicita delle basi di Lagrange per punti equispaziati <span class="math notranslate nohighlight">\(t_{-p}, t_{-p+1}, \ldots, t_0, t_1 \)</span>con distanza <span class="math notranslate nohighlight">\(h\)</span> tra loro.</p>
<p>Consideriamo un esempio con <span class="math notranslate nohighlight">\(p = 1\)</span>, ovvero un polinomio di grado 2. Questo significa che utilizziamo tre punti <span class="math notranslate nohighlight">\(t_{-1}, t_0, t_1\)</span> con una distanza <span class="math notranslate nohighlight">\(h\)</span> tra loro. I punti sono dati da:</p>
<div class="math notranslate nohighlight">
\[
t_{-1} = -h, \quad t_0 = 0, \quad t_1 = h
\]</div>
<p>Deriviamo le basi di Lagrange per questi punti.</p>
</section>
<section id="base-l-1-t">
<h3>Base <span class="math notranslate nohighlight">\(L_{-1}(t)\)</span><a class="headerlink" href="#base-l-1-t" title="Link a questa intestazione">#</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
L_{-1}(t) = \prod_{\substack{-1 \le m \le 1 \\ m \ne -1}} \frac{\frac{t}{h} - m}{-1 - m} = \frac{\frac{t}{h} - 0}{-1 - 0} \cdot \frac{\frac{t}{h} - 1}{-1 - 1}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
L_{-1}(t) = \frac{\frac{t}{h}}{-1} \cdot \frac{\frac{t}{h} - 1}{-2}
\]</div>
<div class="math notranslate nohighlight">
\[
L_{-1}(t) = -\frac{t}{h} \cdot \frac{t - h}{2h}
\]</div>
<div class="math notranslate nohighlight">
\[
L_{-1}(t) = -\frac{t(t - h)}{2h^2}
\]</div>
</section>
<section id="base-l-0-t">
<h3>Base <span class="math notranslate nohighlight">\(L_0(t)\)</span><a class="headerlink" href="#base-l-0-t" title="Link a questa intestazione">#</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
L_0(t) = \prod_{\substack{-1 \le m \le 1 \\ m \ne 0}} \frac{\frac{t}{h} - m}{0 - m} = \frac{\frac{t}{h} + 1}{0 + 1} \cdot \frac{\frac{t}{h} - 1}{0 - 1}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
L_0(t) = \left( \frac{t + h}{h} \right) \cdot \left( \frac{t - h}{-h} \right)
\]</div>
<div class="math notranslate nohighlight">
\[
L_0(t) = \frac{(t + h)(t - h)}{-h^2}
\]</div>
<div class="math notranslate nohighlight">
\[
L_0(t) = \frac{t^2 - h^2}{-h^2}
\]</div>
<div class="math notranslate nohighlight">
\[
L_0(t) = -\frac{t^2 - h^2}{h^2}
\]</div>
</section>
<section id="id1">
<h3>Base <span class="math notranslate nohighlight">\(L_1(t)\)</span><a class="headerlink" href="#id1" title="Link a questa intestazione">#</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
L_1(t) = \prod_{\substack{-1 \le m \le 1 \\ m \ne 1}} \frac{\frac{t}{h} - m}{1 - m} = \frac{\frac{t}{h} + 1}{1 + 1} \cdot \frac{\frac{t}{h} - 0}{1 - 0}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
L_1(t) = \frac{\frac{t}{h} + 1}{2} \cdot \frac{\frac{t}{h}}{1}
\]</div>
<div class="math notranslate nohighlight">
\[
L_1(t) = \frac{t + h}{2h} \cdot \frac{t}{h}
\]</div>
<div class="math notranslate nohighlight">
\[
L_1(t) = \frac{(t + h)t}{2h^2}
\]</div>
</section>
<section id="riepilogo-delle-basi-di-lagrange">
<h3>Riepilogo delle Basi di Lagrange<a class="headerlink" href="#riepilogo-delle-basi-di-lagrange" title="Link a questa intestazione">#</a></h3>
<p>Quindi, le basi di Lagrange per <span class="math notranslate nohighlight">\(p = 1\)</span> su punti <span class="math notranslate nohighlight">\(t_{-1}, t_0, t_1\)</span> con distanza <span class="math notranslate nohighlight">\(h\)</span> tra loro sono:</p>
<div class="math notranslate nohighlight">
\[
L_{-1}(t) = -\frac{t(t - h)}{2h^2}
\]</div>
<div class="math notranslate nohighlight">
\[
L_0(t) = -\frac{t^2 - h^2}{h^2}
\]</div>
<div class="math notranslate nohighlight">
\[
L_1(t) = \frac{(t + h)t}{2h^2}
\]</div>
<p>Queste basi di Lagrange possono essere utilizzate per costruire i polinomi di interpolazione e approssimare l’integrale o la derivata, come richiesto nei metodi di Adams e BDF.</p>
</section>
<section id="adams-bashforth-esplicito">
<h3>Adams-Bashforth (Esplicito)<a class="headerlink" href="#adams-bashforth-esplicito" title="Link a questa intestazione">#</a></h3>
<p>Come detto, per il metodo di Adams-Bashforth, l’integrale viene approssimato utilizzando l’interpolazione polinomiale di Lagrange basata sui valori di <span class="math notranslate nohighlight">\(f\)</span> in tutti i punti a disposizione nei precedenti <span class="math notranslate nohighlight">\(p\)</span> intervalli, ad esclusione dell’ultimo. Ad esempio, per il metodo di Adams-Bashforth di ordine 2, usiamo i punti <span class="math notranslate nohighlight">\( t_n \)</span> e <span class="math notranslate nohighlight">\( t_{n-1} \)</span>:</p>
<div class="math notranslate nohighlight">
\[y_{n+1} = y_n + h \left( \frac{3}{2} f(t_n, y_n) - \frac{1}{2} f(t_{n-1}, y_{n-1}) \right)\]</div>
<p>Da wikipedia, questi sono i primi Adams-Bashfort methods:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
y_{n+1} &amp;= y_n + hf(t_n, y_n) , \qquad\text{(This is the Euler method)} \\
y_{n+2} &amp;= y_{n+1} + h\left( \frac{3}{2}f(t_{n+1}, y_{n+1}) - \frac{1}{2}f(t_n, y_n) \right) , \\
y_{n+3} &amp;= y_{n+2} + h\left( \frac{23}{12} f(t_{n+2}, y_{n+2}) - \frac{16}{12} f(t_{n+1}, y_{n+1}) + \frac{5}{12}f(t_n, y_n)\right) , \\
y_{n+4} &amp;= y_{n+3} + h\left( \frac{55}{24} f(t_{n+3}, y_{n+3}) - \frac{59}{24} f(t_{n+2}, y_{n+2}) + \frac{37}{24} f(t_{n+1}, y_{n+1}) - \frac{9}{24} f(t_n, y_n) \right) , \\
y_{n+5} &amp;= y_{n+4} + h\left( \frac{1901}{720} f(t_{n+4}, y_{n+4}) - \frac{2774}{720} f(t_{n+3}, y_{n+3}) + \frac{2616}{720} f(t_{n+2}, y_{n+2}) - \frac{1274}{720} f(t_{n+1}, y_{n+1}) + \frac{251}{720} f(t_n, y_n) \right) .
\end{align}
\end{split}\]</div>
</section>
<section id="adams-moulton-implicito">
<h3>Adams-Moulton (Implicito)<a class="headerlink" href="#adams-moulton-implicito" title="Link a questa intestazione">#</a></h3>
<p>Per il metodo di Adams-Moulton, l’interpolazione polinomiale viene fatta utilizzando anche il punto <span class="math notranslate nohighlight">\(t_{n+1}\)</span>, rendendo il metodo implicito. Ad esempio, per il metodo di Adams-Moulton di ordine 2, usiamo i punti  <span class="math notranslate nohighlight">\(t_{n+1}, t_n\)</span>, e ritroviamo il metodo dei trapezi:</p>
<div class="math notranslate nohighlight">
\[y_{n+1} = y_n + \frac{h}{2} \left( f(t_{n+1}, y_{n+1}) + f(t_n, y_n) \right)\]</div>
<p>Da wikipedia, questa è la tabulazione per i primi Adams-Moulton methods:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
y_{n} &amp;= y_{n-1} + h f(t_{n},y_{n}), \\
y_{n+1} &amp;= y_n + \frac{1}{2} h \left( f(t_{n+1},y_{n+1}) + f(t_n,y_n) \right), \\
y_{n+2} &amp;= y_{n+1} + h \left( \frac{5}{12} f(t_{n+2},y_{n+2}) + \frac{8}{12} f(t_{n+1},y_{n+1}) - \frac{1}{12} f(t_n,y_n) \right) , \\
y_{n+3} &amp;= y_{n+2} + h \left( \frac{9}{24} f(t_{n+3},y_{n+3}) + \frac{19}{24} f(t_{n+2},y_{n+2}) - \frac{5}{24} f(t_{n+1},y_{n+1}) + \frac{1}{24} f(t_n,y_n) \right) , \\
y_{n+4} &amp;= y_{n+3} + h \left( \frac{251}{720} f(t_{n+4},y_{n+4}) + \frac{646}{720} f(t_{n+3},y_{n+3}) - \frac{264}{720} f(t_{n+2},y_{n+2}) + \frac{106}{720} f(t_{n+1},y_{n+1}) - \frac{19}{720} f(t_n,y_n) \right) .
\end{align}
\end{split}\]</div>
</section>
<section id="bdf-di-ordine-2">
<h3>BDF di ordine 2<a class="headerlink" href="#bdf-di-ordine-2" title="Link a questa intestazione">#</a></h3>
<p>Per il metodo BDF di ordine 2, utilizziamo l’interpolazione polinomiale basata sui punti <span class="math notranslate nohighlight">\( t_{n-1}, t_n, t_{n+1} \)</span>:</p>
<div class="math notranslate nohighlight">
\[I(y)'(t_{n+1}) = \frac{1}{h} \left( \frac{1}{2} y_{n-1} - 2 y_n + \frac{3}{2} y_{n+1}  \right)\]</div>
<p>Poiché <span class="math notranslate nohighlight">\( I(y)'(t_{n+1}) = f(t_{n+1}, y_{n+1}) \)</span>, otteniamo:</p>
<div class="math notranslate nohighlight">
\[f(t_{n+1}, y_{n+1}) = \frac{1}{h} \left( \frac{3}{2} y_{n+1} - 2 y_n + \frac{1}{2} y_{n-1} \right)\]</div>
<p>Risolviamo per <span class="math notranslate nohighlight">\( y_{n+1} \)</span>:</p>
<div class="math notranslate nohighlight">
\[y_{n+1} = \frac{4}{3} y_n - \frac{1}{3} y_{n-1} + \frac{2h}{3} f(t_{n+1}, y_{n+1})\]</div>
<p>Da wikipedia, i primi BDF methods sono:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
 &amp; y_{n+1} - y_n = h f(t_{n+1}, y_{n+1}) \\
 &amp; y_{n+2} - \tfrac43 y_{n+1} + \tfrac13 y_n = \tfrac23 h f(t_{n+2}, y_{n+2}) \\
 &amp; y_{n+3} - \tfrac{18}{11} y_{n+2} + \tfrac9{11} y_{n+1} - \tfrac2{11} y_n = \tfrac6{11} h f(t_{n+3}, y_{n+3}) \\
 &amp; y_{n+4} - \tfrac{48}{25} y_{n+3} + \tfrac{36}{25} y_{n+2} - \tfrac{16}{25} y_{n+1} + \tfrac{3}{25} y_n = \tfrac{12}{25} h f(t_{n+4}, y_{n+4}) \\
 &amp; y_{n+5} - \tfrac{300}{137} y_{n+4} + \tfrac{300}{137} y_{n+3} - \tfrac{200}{137} y_{n+2} + \tfrac{75}{137} y_{n+1} - \tfrac{12}{137} y_n = \tfrac{60}{137} h
\end{aligned}
\end{split}\]</div>
</section>
</section>
<section id="implementazione">
<h2>Implementazione<a class="headerlink" href="#implementazione" title="Link a questa intestazione">#</a></h2>
<p>Implementeremo i metodi di Adams-Bashforth di ordine 2,  Adams-Moulton di ordine 3, e BDF di ordine 2 utilizzando i seguenti prototipi di funzione in MATLAB.</p>
<section id="metodo-di-adams-bashforth">
<h3>Metodo di Adams-Bashforth<a class="headerlink" href="#metodo-di-adams-bashforth" title="Link a questa intestazione">#</a></h3>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[y, t] = adams_bashforth</span><span class="p">(</span>f, y0, a, b, h<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">%ADAMS_BASHFORTH Implementa il metodo di Adams-Bashforth di ordine 2.</span><span class="w"></span>
<span class="w">    </span><span class="c">% INPUT:</span><span class="w"></span>
<span class="w">    </span><span class="c">%        f   = handle della funzione che specifica l&#39;equazione differenziale f(t,y)</span><span class="w"></span>
<span class="w">    </span><span class="c">%        y0  = vettore dei valori iniziali</span><span class="w"></span>
<span class="w">    </span><span class="c">%        a,b = estremi dell&#39;intervallo di integrazione</span><span class="w"></span>
<span class="w">    </span><span class="c">%        h   = passo di integrazione</span><span class="w"></span>
<span class="w">    </span><span class="c">% OUTPUT:</span><span class="w"></span>
<span class="w">    </span><span class="c">%        y = valori calcolati della soluzione nei corrispondenti valori di t</span><span class="w"></span>
<span class="w">    </span><span class="c">%        t = valori di t nei quali è stata calcolata la soluzione</span><span class="w"></span>

<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="metodo-di-adams-moulton">
<h3>Metodo di Adams-Moulton<a class="headerlink" href="#metodo-di-adams-moulton" title="Link a questa intestazione">#</a></h3>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[y, t] = adams_moulton</span><span class="p">(</span>f, y0, a, b, h<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">%ADAMS_MOULTON Implementa il metodo di Adams-Moulton di ordine 3.</span><span class="w"></span>
<span class="w">    </span><span class="c">% INPUT:</span><span class="w"></span>
<span class="w">    </span><span class="c">%        f   = handle della funzione che specifica l&#39;equazione differenziale f(t,y)</span><span class="w"></span>
<span class="w">    </span><span class="c">%        y0  = vettore dei valori iniziali</span><span class="w"></span>
<span class="w">    </span><span class="c">%        a,b = estremi dell&#39;intervallo di integrazione</span><span class="w"></span>
<span class="w">    </span><span class="c">%        h   = passo di integrazione</span><span class="w"></span>
<span class="w">    </span><span class="c">% OUTPUT:</span><span class="w"></span>
<span class="w">    </span><span class="c">%        y = valori calcolati della soluzione nei corrispondenti valori di t</span><span class="w"></span>
<span class="w">    </span><span class="c">%        t = valori di t nei quali è stata calcolata la soluzione</span><span class="w"></span>

<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>BDF di ordine 2<a class="headerlink" href="#id2" title="Link a questa intestazione">#</a></h3>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[y, t] = bdf2</span><span class="p">(</span>f, y0, a, b, h<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">%BDF2 Implementa il metodo BDF di ordine 2.</span><span class="w"></span>
<span class="w">    </span><span class="c">% INPUT:</span><span class="w"></span>
<span class="w">    </span><span class="c">%        f   = handle della funzione che specifica l&#39;equazione differenziale f(t,y)</span><span class="w"></span>
<span class="w">    </span><span class="c">%        y0  = vettore dei valori iniziali</span><span class="w"></span>
<span class="w">    </span><span class="c">%        a,b = estremi dell&#39;intervallo di integrazione</span><span class="w"></span>
<span class="w">    </span><span class="c">%        h   = passo di integrazione</span><span class="w"></span>
<span class="w">    </span><span class="c">% OUTPUT:</span><span class="w"></span>
<span class="w">    </span><span class="c">%        y = valori calcolati della soluzione nei corrispondenti valori di t</span><span class="w"></span>
<span class="w">    </span><span class="c">%        t = valori di t nei quali è stata calcolata la soluzione</span><span class="w"></span>

<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="problema-di-test">
<h3>Problema di Test<a class="headerlink" href="#problema-di-test" title="Link a questa intestazione">#</a></h3>
<p>Testiamo i metodi sul seguente problema:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Metodo di Adams-Bashforth, Adams-Moulton e BDF</span><span class="w"></span>

<span class="nb">clear</span><span class="p">;</span><span class="w"> </span><span class="nb">clc</span><span class="p">;</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="s">all</span><span class="p">;</span><span class="w"></span>

<span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">t</span>^<span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span>^<span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">t</span><span class="p">);</span><span class="w"></span>
<span class="n">ytrue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">t</span><span class="o">.^</span><span class="mi">2</span><span class="o">.*</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>

<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="n">h</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span><span class="w"></span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="p">[</span><span class="n">y_ab</span><span class="p">,</span><span class="w"> </span><span class="n">t_ab</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">adams_bashforth</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span><span class="w"></span>
<span class="p">[</span><span class="n">y_am</span><span class="p">,</span><span class="w"> </span><span class="n">t_am</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">adams_moulton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span><span class="w"></span>
<span class="p">[</span><span class="n">y_bdf2</span><span class="p">,</span><span class="w"> </span><span class="n">t_bdf2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bdf2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_ab</span><span class="p">,</span><span class="w"> </span><span class="n">y_ab</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r--&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t_ab</span><span class="p">,</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">t_ab</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Computed Solution (Adams-Bashforth)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;True Solution&#39;</span><span class="p">},</span><span class="w"> </span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">);</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_am</span><span class="p">,</span><span class="w"> </span><span class="n">y_am</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;g--&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t_am</span><span class="p">,</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">t_am</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Computed Solution (Adams-Moulton)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;True Solution&#39;</span><span class="p">},</span><span class="w"> </span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">);</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_bdf2</span><span class="p">,</span><span class="w"> </span><span class="n">y_bdf2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k--&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t_bdf2</span><span class="p">,</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">t_bdf2</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Computed Solution (BDF2)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;True Solution&#39;</span><span class="p">},</span><span class="w"> </span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">);</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">t_ab</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">y_ab</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">t_ab</span><span class="p">)),</span><span class="w"> </span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"></span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">t_am</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">y_am</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">t_am</span><span class="p">)),</span><span class="w"> </span><span class="s">&#39;g-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">t_bdf2</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">y_bdf2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">t_bdf2</span><span class="p">)),</span><span class="w"> </span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Errore Assoluto&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Errore Adams-Bashforth&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Errore Adams-Moulton&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Errore BDF2&#39;</span><span class="p">},</span><span class="w"> </span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="analisi-della-convergenza">
<h2>Analisi della Convergenza<a class="headerlink" href="#analisi-della-convergenza" title="Link a questa intestazione">#</a></h2>
<p>Possiamo analizzare la convergenza dei metodi confrontando l’errore rispetto alla soluzione esatta:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Convergenza</span><span class="w"></span>
<span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fliplr</span><span class="p">(</span><span class="nb">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">));</span><span class="w"></span>
<span class="n">err_ab</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="n">err_am</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">y_ab</span><span class="p">,</span><span class="w"> </span><span class="n">t_ab</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">adams_bashforth</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">y_am</span><span class="p">,</span><span class="w"> </span><span class="n">t_am</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">adams_moulton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">yt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ytrue</span><span class="p">(</span><span class="n">t_ab</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">err_ab</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">norm</span><span class="p">(</span><span class="n">y_ab</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yt</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">norm</span><span class="p">(</span><span class="n">yt</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">err_am</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">norm</span><span class="p">(</span><span class="n">y_am</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yt</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">norm</span><span class="p">(</span><span class="n">yt</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="nb">loglog</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">err_ab</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;o-&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">err_am</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;x-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">)</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Errore Relativo&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;Errore Adams-Bashforth&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Errore Adams-Moulton&#39;</span><span class="p">},</span><span class="w"> </span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Da questa analisi possiamo osservare come i metodi di ordine più elevato raggiungono la precisione desiderata con un numero minore di passi di integrazione rispetto ai metodi di ordine inferiore, riducendo il costo computazionale.</p>
<div class="admonition-esercizio admonition">
<p class="admonition-title">Esercizio</p>
<p>Implementate i metodi di Adams-Bashforth e Adams-Moulton di ordine 2 utilizzando i prototipi forniti e testateli sul problema descritto sopra. Verificate la convergenza dei metodi e confrontate i risultati.</p>
</div>
<p>Buon lavoro!</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="laboratorio12.html" title="precedente pagina">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">precedente</p>
            <p class="prev-next-title">Laboratorio 11 : Metodi per la Soluzione di ODE</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By F. Durastante, L. Heltai, C. Pagliantini<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>